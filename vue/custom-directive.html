<!DOCTYPE html>
<html lang="en" xmlns:v-custom-directive2="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>custom-directive</title>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/vue/1.0.13/vue.js"></script>
</head>
<body>
<div id="div1">
    <div v-custom-directive1="someValue">{{someValue}}</div>
</div>
<script type="text/javascript">
    Vue.directive('custom-directive1', {
        bind: function () {
            // 准备工作
            // 例：添加事件处理器或者需要运行一次的高耗任务
        },
        update: function (newValue, oldValue) {
            // 值更新时的工作
            // 也会以初始值为参数调用一次
            console.log('newValue: ' + newValue);
            console.log('oldValue: ' + oldValue);
        },
        unbind: function () {
            // 清理工作
        }
    });

    var vm1 = new Vue({
        el: '#div1',
        data: {
            someValue: 1
        }
    });
</script>
<hr>
<div id="div2" v-custom-directive2:hello.a.b="msg"></div>
<script type="text/javascript">
    Vue.directive('custom-directive2', {
        bind: function () {
            console.log('demo bound!');
        },
        update: function (value) {
            this.el.innerHTML =
//                    'vm - ' + JSON.stringify(this.vm) + '<br>' +
                    'expression - ' + this.expression + '<br>' +
                    'argument - ' + this.arg + '<br>' +
                    'name - ' + this.name + '<br>' +
                    'modifiers - ' + JSON.stringify(this.modifiers) + '<br>' +
                    'descriptor - ' + JSON.stringify(this.descriptor) + '<br>' +
                    'value - ' + value;
        }
    });

    var vm2 = new Vue({
        el: '#div2',
        data: {
            msg: 'hello!'
        }
    });
</script>
<hr>
3
<div id="div3" v-custom-directive3 a="hi"></div>
<script type="text/javascript">
    Vue.directive('custom-directive3', {
        params: ['a'],
        bind: function () {
            console.log(this.params.a);
        }
    });
    var vm3 = new Vue({
        el: '#div3'
    })
</script>
<hr>
4
<div id="div4" v-custom-directive4 :a="hi"></div>
<script type="text/javascript">
    Vue.directive('custom-directive4', {
        param: ['a'],
        paramWatchers: {
            a: function (val, oldVal) {
                console.log(val, oldVal);
                console.log('a changed!');
            }
        }
    });

    var div4 = new Vue({
        el: '#div4',
        data: {
            a: 2
        }
    });
</script>
<hr>
<h6>toWay</h6>
<div id="div5">
    <input v-custom-directive5="a">
    {{a}}
</div>
<script type="text/javascript">
    Vue.directive('custom-directive5', {
        twoWay: true,
        bind: function () {
            this.handler = function () {
                // 将数据写回 vm
                // 如果指令这样绑定 v-example="a.b.c"
                // 它将用给定值设置 `vm.a.b.c`
                this.set(this.el.value);
                console.log(this.el.value);
            }.bind(this);
            this.el.addEventListener('input', this.handler);
        },
        unbind: function () {
            this.el.removeEventListener('input', this.handler);
        }
    });
    var div5 = new Vue({
        el: '#div5',
        data: {
            a: 1
        }
    });
</script>
<h6>acceptStatement</h6>
<div id="vm6" v-custom-directive6="a++">{{a}}</div>
<script type="text/javascript">
    Vue.directive('custom-directive6', {
        acceptStatement: true,
        update: function (fn) {
            console.log(JSON.stringify(fn));
        }
    });

    var vm6 = new Vue({
        el: '#vm6',
        data: {
            a: 100
        }
    })
</script>
</body>
</html>